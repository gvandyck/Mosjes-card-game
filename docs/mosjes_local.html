<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>MOSJES - Local MVP</title>
    <script src="https://www.gstatic.com/firebasejs/10.5.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.5.0/firebase-database-compat.js"></script>
    <link rel="stylesheet" href="style.css">
</head>

<body>
    <!-- Firebase Modal -->
    <div id="firebaseModal" class="modal">
        <div class="card">
            <h3 style="color:var(--accent);margin:0 0 8px 0">Firebase Setup</h3>
            <div class="small">Get these from Firebase Console â†’ Project Settings</div>
            <div style="margin-top:8px">
                <input id="apiKey" class="input" placeholder="API Key" value="AIzaSyCAGazLyW_o3PNLy4tF8jccqdqd49tn9zk" />
                <input id="projectId" class="input" placeholder="Project ID" style="margin-top:8px" value="mosjes-card-game"/>
                <input id="databaseUrl" class="input" placeholder="Database URL (https://...firebaseio.com)" style="margin-top:8px" value="https://mosjes-card-game-default-rtdb.firebaseio.com/"/>
            </div>
            <div style="display:flex;gap:8px;margin-top:10px">
                <button class="btn" onclick="initFirebase()">Connect</button>
                <button class="btn" onclick="skipFirebase()">Skip (Local Play)</button>
            </div>
            <p class="smallMuted" style="margin-top:10px">If you don't have Firebase yet: create a free project and
                Realtime Database (test mode).</p>
        </div>
    </div>

    <!-- Room Modal -->
    <div id="roomModal" class="modal" style="display:none">
        <div class="card">
            <h3 style="color:var(--accent);margin:0 0 8px 0">Create or Join Room</h3>
            <div style="display:flex;gap:8px">
                <button class="btn" onclick="createRoom()">Create New Game</button>
                <input id="joinCode" class="input" placeholder="Enter 6-char code" />
                <button class="btn" onclick="joinRoom()">Join</button>
            </div>
            <div id="roomHint" class="smallMuted" style="margin-top:8px"></div>
        </div>
    </div>

    <!-- Deck Modal -->
    <div id="deckModal" class="modal" style="display:none">
        <div class="card" style="width:90%; max-width:520px">
            <h3 style="color:var(--accent);margin:0 0 8px 0">Pick One Starter Deck</h3>
            <div style="display:flex;gap:8px;flex-direction:column">
                <button class="btn" onclick="pickDeck(0)" style="background:#ff6b6b">Physical Force (Aggro)</button>
                <button class="btn" onclick="pickDeck(1)" style="background:#4ecdc4">Digital Control (Tactical)</button>
                <button class="btn" onclick="pickDeck(2)" style="background:#c44569">Artistic Rhythm (Combo)</button>
            </div>
            <div class="smallMuted" style="margin-top:10px">Each player picks ONE Mosje when deck selected; play starts
                when both ready.</div>
        </div>
    </div>

    <div class="topbar">
        <div style="display:flex;align-items:center;gap:16px">
            <strong>Room:</strong> <span id="roomCode">--</span>
            <div id="statusText">Not connected</div>
        </div>
        <div id="turnIndicator" class="turn" style="position:static;float:right;margin-left:auto;">Waiting</div>
    </div>

    <div class="container">
        <div class="board" style="display:flex;flex-direction:column;gap:16px;">
            <!-- Top Row: Opponent, Quest, Place, Turn -->
            <div style="display:flex;gap:16px;align-items:flex-start;justify-content:space-between; flex-wrap: wrap;">
                <div class="area" id="oppArea" style="margin-bottom:0;min-width:320px; flex: 1;">
                    <div class="flex" style="justify-content:space-between">
                        <div><strong>Opponent</strong></div>
                    </div>
                    <div style="display:flex;gap:16px;margin-top:8px;align-items:flex-start">
                        <div id="oppMosje" class="mosje">No Mosje</div>
                        <div class="pieSlots" id="oppPiecies"></div>
                    </div>
                </div>
                <div style="display:flex;flex-direction:row;gap:12px;align-items:flex-start; flex-wrap: wrap;">
                    <div class="area" style="min-width:180px;max-width:220px;flex:1;padding:10px 8px;">
                        <div style="font-weight:700">Quest Deck</div>
                        <div class="questCard" id="activeQuest" style="margin-top:8px">No active quest</div>
                        <div style="margin-top:8px;display:flex;gap:8px">
                            <button class="btn" id="questBtn" onclick="drawAndAttemptQuest()">Draw & Attempt Quest</button>
                        </div>
                    </div>
                    <div class="area" style="min-width:140px;max-width:180px;flex:1;padding:10px 8px;">
                        <div style="font-weight:700">Shared Place</div>
                        <div class="questCard" id="sharedPlace" style="margin-top:8px">No Place</div>
                    </div>
                </div>
            </div>

            <!-- My Field (bottom) -->
            <div class="area" id="myArea" style="margin-top:0;">
                <div class="flex" style="justify-content:space-between">
                    <div><strong>You</strong></div>
                    <div class="smallMuted">Hand: <span id="myHandCount">0</span></div>
                </div>
                <div style="display:flex;gap:16px;margin-top:8px;align-items:flex-start">
                    <div id="myMosje" class="mosje">No Mosje</div>
                    <div class="pieSlots" id="myPiecies"></div>
                </div>
                <div style="margin-top:8px">
                    <div class="smallMuted">Actions:</div>
                    <div style="display:flex;gap:8px;margin-top:6px">
                        <button class="btn" id="placePiecieBtn" onclick="placePiecie()">Place Piecie</button>
                        <button class="btn" id="activatePlacedBtn" onclick="activatePlaced()">Activate Placed</button>
                    </div>
                </div>
            </div>

            <!-- My Hand (bottom) -->
            <div class="area" style="margin-top:0;">
                <div style="display:flex;justify-content:space-between;align-items:center">
                    <div><strong>Your Hand</strong></div>
                    <div class="smallMuted">Deck: <span id="myDeckCount">0</span> | Discard:
                        <span id="myDiscard">0</span></div>
                </div>
                <div class="hand" id="handArea" style="margin-top:8px"></div>
                <div style="margin-top:8px;display:flex;gap:8px">
                    <button class="btn" id="drawBtn" onclick="drawCard()">Draw</button>
                    <button class="btn" id="endMainBtn" onclick="endMainPhase()">End Main</button>
                    <button class="btn btnDanger" id="endTurnBtn" onclick="endTurn()">End Turn</button>
                </div>
            </div>
            <div class="area log" id="log"></div>
        </div>
    </div>

    <script src="script.js?v=8"></script>
</body>

</html>